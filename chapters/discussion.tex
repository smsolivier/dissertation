%!TEX root = ../doc.tex
\documentclass[../doc.tex]{subfiles}

\begin{document}
\chapter{Additional Results and Discussion}
\section{Using Outer Iteration as Initial Guess for Inner Solver}
% --- comparison of convergence --- 
\begin{figure}
\centering 
\begin{subfigure}{.32\textwidth}
	\centering
	\includegraphics[width=\textwidth]{figs/disc/iguess.pdf}
	\caption{}
\end{subfigure}
\begin{subfigure}{.32\textwidth}
	\centering
	\includegraphics[width=\textwidth]{figs/disc/iguess_1.pdf}
	\caption{}
\end{subfigure}
\begin{subfigure}{.32\textwidth}
	\centering
	\includegraphics[width=\textwidth]{figs/disc/iguess_2.pdf}
	\caption{}
\end{subfigure}
\caption{A comparison of the number of inner iterations to convergence at each outer iteration when the inner solver used the previous outer iteration as the initial guess and when an initial guess of zero was used for each iteration. The most refined mesh for polynomials orders (a) 1, (b), 2, and (c) 3 are shown. Using the previous outer iteration as an initial guess reduces the total number of inner iterations required to solve the problem.}
\label{disc:iguess}
\end{figure}

% --- cumulative version --- 
\begin{figure}
\centering 
\begin{subfigure}{.32\textwidth}
	\centering
	\includegraphics[width=\textwidth]{figs/disc/ciguess.pdf}
	\caption{}
\end{subfigure}
\begin{subfigure}{.32\textwidth}
	\centering
	\includegraphics[width=\textwidth]{figs/disc/ciguess_1.pdf}
	\caption{}
\end{subfigure}
\begin{subfigure}{.32\textwidth}
	\centering
	\includegraphics[width=\textwidth]{figs/disc/ciguess_2.pdf}
	\caption{}
\end{subfigure}
\caption{A comparison of the cumulative number of inner iterations to convergence as the outer iteration progresses when the inner solver used the previous outer iteration as the initial guess and when an initial guess of zero was used for each iteration. The most refined mesh for polynomials orders (a) 1, (b), 2, and (c) 3 are shown. Using the previous outer iteration as the initial guess reduced the total number of inner iterations to solve the problem by 53, 82, and 118, respectively. This represents a reduction in inner iterations of 25\%, 30\%, and 31\%, respectively.}
\label{disc:ciguess}
\end{figure}

% --- outer and inner on crooked pipe hp --- 
\begin{table}
\centering
\caption{The number of Anderson-accelerated fixed-point iterations and the maximum, minimum, and total number of inner iterations performed across all outer iterations for the IP VEF method on the crooked pipe problem refined in $h$ and $p$. An Anderson space of size two is used. The effect of using the previous outer iteration's solution as an initial guess for the inner solver is compared to using an initial guess of zero at each inner iteration. }
\label{}
\input{figs/cp_iguess}
\end{table}

\section{Acceleration of Inexact Sweeps on the Triple Point Mesh}

% --- multiple sweeps on triple point mesh --- 
\begin{table}
\centering
\caption{The number of fixed-point iterations to convergence on the triple point mesh in the thick diffusion limit. On the triple point mesh, the transport equation is not inverted exactly at each iteration due to the presence of re-entrant faces. The performance of the IP VEF method with $p=2$ is compared when 1, 2, and 3 partial inversions of the transport equation are performed at each fixed-point iteration. More transport inversions leads to faster convergence but not to the point that fewer total inversions are performed. }
\label{disc:mult_sweeps}
\input{figs/disc/eps3}
\end{table}

% --- anderson acceleration on triple point mesh --- 
\begin{table}
\centering
\caption{The number of Anderson-accelerated fixed-point iterations to solve the thick diffusion limit problem on the triple point mesh. Fixed-point iteration is compared to Anderson-accelerated fixed-point iteration with an Anderson space of five scalar flux solution vectors (Low Memory) and five scalar and angular flux solution vectors (Augmented). The slowdown of the Low Memory option indicates Anderson cannot accelerate the slowdown from inexact sweeps when the angular flux is not included in the Anderson space. }
\label{disc:anderson}
\input{figs/disc/anderson}
\end{table}

\section{Comparison of Methods}
\subsection{Solution Quality on the Triple Point Mesh}
\begin{figure}
\centering
\foreach \f in {ip.png, mdldg.png, cg.png, hrt.png}{
	\begin{subfigure}{.49\textwidth}
		\centering
		\includegraphics[width=\textwidth]{data/img/3psol/\f}
		\caption{}
	\end{subfigure}
}
\caption{Plots of the scalar flux from the thick diffusion limit problem with $\epsilon = 10^{-2}$ on the triple point mesh for the (a) interior penalty, (b) MDLDG, (c) CG, and (d) HRT VEF methods. The solution should be smoothly varying and obey a maximum principle. Deviations from this behavior are due to mesh imprinting. These plots show that the IP and CG methods have nearly identical solution quality and in particular have continuous contour lines. The MDLDG and HRT methods produced solutions with discontinuous contour lines.}
\label{disc:3psol}
\end{figure}

\subsection{Implementation Details}
\subsection{VEF vs SMM}

\section{Recommendations for Implementation in Production}

\end{document}