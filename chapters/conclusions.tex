%!TEX root = ../doc.tex
\documentclass[../doc.tex]{subfiles}

\begin{document}
\chapter{Conclusions} \label{chap:conclusions}
This dissertation has developed efficient, high-order finite element radiation transport methods that are compatible with curved meshes. \gls{vef} methods and \glspl{smm} were developed for the steady-state, mono-energetic, Boltzmann transport equation with isotropic scattering. This model problem emulates the requirements of a single time step of a more complicated \gls{trt} algorithm and has been demonstrated to be an effective proxy for mathematical research into the design of \gls{trt} algorithms in \textcite{yee_mc21}. We developed two classes of discretization techniques for the moment systems arising in both VEF and SMM. This led to a total of 10 novel moment methods each with 
	\begin{enumerate}
		\item high-order accuracy, 
		\item compatibility with curved meshes, and 
		\item efficient preconditioned iterative solvers. 
	\end{enumerate}
These methods are the first to have \emph{any} of the above properties. The methods are based on an independent discretization approach where the transport and moment equations are discretized separately. This allows the flexibility to design moment algorithms where the transport and moment discretizations are in some sense optimal for their intended uses. In our case, we elected to choose the discretization for the moment system to be able to leverage existing linear solver technology and to have multiphysics compatibility with the hydrodynamics framework of \cite{blast}. The discretizations for the moment system were paired with a \gls{dg} discretization of the \gls{sn} transport equations to form effective linear transport algorithms. 

In this chapter, we summarize the results from Chapters \ref{chap:dgvef} -- \ref{chap:disc} and outline future directions for the methods presented here. 

\section{Discontinuous Galerkin VEF}
In Chapter \ref{chap:dgvef}, the unified framework for \gls{dg} methods presented by \textcite{Arnold2002} was extended to the non-symmetric \gls{vef} equations. In this framework, a clever choice of numerical flux allows a local elimination of the vector-valued, first moment equation. This allows formation of a discretization for the second-order form of the VEF equations. The local elimination of the first moment is stabilized with penalization terms and/or the so-called lifting operators. Such terms ensure the resulting algebraic system will be positive definite. 

Using this extended framework, we derived analogs of the \gls{ip}, \gls{br2}, \gls{mdldg}, and \gls{cg} methods. The \gls{cg} method represents an extension to multiple dimensions, high-order, curved meshes, and efficient solvers of the method of \textcite{two-level-independent-warsa}. 
The recently developed \gls{usc} preconditioning technique from \textcite{Pazner2021} was extended to the IP and BR2 methods. This preconditioner uses a decomposition of the DG finite element space into a CG and DG space. \gls{amg} is applied to an operator corresponding to the CG part of the space. A simple Jacobi iteration is used to approximate the inverse of the operator associated with the DG part. This allows leveraging the efficiency of \gls{amg} as applied to CG elliptic operators. When combined with the \gls{bicg}, this preconditioning technique led to iteration counts that were independent of the mesh size, polynomial order, and penalty parameter. The MDLDG and CG techniques were effectively preconditioned by \gls{amg}. A \gls{mms} problem demonstrated that all methods converged optimally on curved meshes for a transport solution that was quadratically anisotropic in angle. 

The DG discretizations of the VEF equations were combined with a DG discretization of the \gls{sn} transport equations to form efficient linear transport algorithms. The methods were demonstrated to be efficient in both outer fixed-point iterations and inner preconditioned iterative solver iterations on single and multi-material problems. Convergence was nearly identical for all the VEF methods: the IP, BR2, and CG methods converged within 1 iteration of each other with MDLDG requiring at most 3 more iterations than the IP, BR2, and CG methods. This indicates that a continuous finite element method can be efficiently and robustly paired to a discontinuous finite element transport discretization. The inner preconditioned iterative solvers were all shown to be scalable in $h$ and $p$. 

Finally, we tested the IP and CG methods in a weak scaling study. The VEF moment systems were solved in parallel out to 1152 processors and over 10 million scalar flux unknowns. 
A non-physically difficult mock problem designed to stress the linear solver was found to cause non-convergence of the \gls{usc} preconditioner applied to the IP discretization. It was found that AMG was struggling to precondition the CG operator. Uniform convergence was recovered by applying AMG to a symmetrized version of the CG operator. The weak scaling study was repeated on a physically realistic problem where the standard USC method converged optimally. AMG was effective for the CG discretization on this problem. 

These results indicate that the choice of the VEF discretization does not significantly impact the convergence of the VEF algorithm. Thus, it is recommended to choose the discretization based on other aspects of the algorithm such as ease of implementation, assembly cost, or the expense of the preconditioned iterative solver. We note that the MDLDG method has an increased assembly cost due to its non-local stencil that is formed using sparse matrix multiplication. The BR2 method is more complicated to implement than the IP method but avoids the need to tune the IP method's penalty parameter. Finally, given that the CG method converged equivalently to the IP and BR2 methods, this study indicates there is no added benefit to using the more complicated and expensive DG techniques. 

\section{Mixed Finite Element VEF}
Mixed finite element discretizations of the VEF moment system were pursued in order to match as closely as possible the \gls{rt}-based radiation diffusion methods used in the hydrodynamics framework of \cite{blast}. Such methods were described by \textcite{pete}. However, the presence of the Eddington tensor in the VEF equations precludes the use of the standard \gls{rt} discretization. In Chapter \ref{chap:rtvef}, we investigated three approaches each of which produces a scalar flux in the DG finite element space expected for the thermodynamic variables of \cite{blast}. 
The methods are differentiated by the choice of finite element space used to approximate the current. We considered: 1) a discrete subspace of $\Hone$ where each component is represented with continuous finite elements, 2) a method that uses the \gls{rt} space along with DG-like numerical fluxes to treat the discontinuities arising from the presence of the Eddington tensor in the VEF first moment equation, and 3) a \gls{hrt} method where continuity of the normal component of the current is enforced weakly with a Lagrange multiplier. These methods are referred to as H1, RT, and HRT, respectively. The VEF discretizations were paired with a high-order DG discretization of the \gls{sn} transport equations to solve problems from linear transport. 

All three methods showed rapid and robust convergence on a single-material thick diffusion limit test problem on both a simple orthogonal mesh and a severely distorted third-order mesh generated with a Lagrangian hydrodynamics code. The methods were tested on mesh and polynomial order refinements of a two-material linearized crooked pipe problem that had a 1000x difference in total cross section. Fixed-point convergence was robust for all three methods with RT and HRT converging equivalently. The H1 method converged slower, requiring $\approx$\!\,1.75x more iterations than RT and HRT on the largest mesh for each polynomial order. 

We also investigated preconditioned iterative solvers for the H1, RT, and HRT methods. Lower block triangular preconditioners were used for the H1 and RT methods that employ Jacobi smoothing on the total interaction mass matrix and \gls{amg} on the lumped Schur complement. The solvers for the HRT method leverage the element-by-element block structure generated by discontinuous approximations to form a reduced system for the Lagrange multiplier only, leading to fewer globally coupled unknowns than in the H1 or RT methods. AMG is applied directly to the reduced problem. The preconditioned iterative solvers were tested on a series of increasingly distorted meshes to test their robustness. The H1 and HRT methods converged for all distortions but the RT method failed to converge once the mesh became too distorted. The RT and HRT methods were shown to have scalable solvers in both $h$ and $p$ on the linearized crooked pipe problem. However, the solvers for H1 were not scalable. It was found that AMG was struggling to adequately precondition the lumped Schur complement due to the presence of highly oscillatory, slowly decaying modes. These modes are a consequence of the mismatch between the finite element spaces used to approximate the VEF scalar flux and current and were present even on a simple Poisson eigenvalue problem. Finally, a weak scaling study demonstrated that the RT and HRT methods can be scalably solved out to 1152 processors and over 10 million VEF scalar flux unknowns. Compared to solving radiation diffusion, solving the non-symmetric VEF equations required at most 9 and 5 more iterations for the RT and HRT methods, respectively.

These results indicate the combination of a DG \gls{sn} discretization and the RT or HRT VEF discretizations form an effective high-order method for linear transport problems. 
Both the RT and HRT discretizations of the VEF equations have high-order accuracy, compatibility with curved meshes, and robust and scalable convergence in both outer fixed-point iterations and inner preconditioned linear solver iterations. 
The performance of the methods are differentiated only in the presence of severely distorted meshes. In such case, the preconditioned iterative solver for the HRT method was robust to mesh distortion whereas the solver for the RT method was not. 
The H1 method is not recommended for use in a production code due to the lack of scalable iterative solvers and its slower fixed-point iteration convergence rate on the linearized crooked pipe problem as compared to the RT and HRT methods. 

In radiation-hydrodynamics calculations, the scalar flux and current are coupled to the hydrodynamics' energy balance and momentum equations, respectively. 
Due to the sub-optimal accuracy of the VEF current on transport problems, it is unclear whether the mixed finite element methods presented here would yield improvements in physics fidelity commensurate with the increased cost of solving for both the VEF scalar flux and current. 

\section{Second Moment Methods}
We also investigated a moment method closely related to the VEF method known as the \gls{smm}. Where VEF uses nonlinear, multiplicative closures, SMM uses linear, additive closures. This allows design of an iterative scheme that only requires the inversion of a simple radiation diffusion system at each iteration. Such a scheme avoids the difficulty of inverting the non-symmetric VEF system required by VEF methods. Since radiation diffusion is symmetric, simpler discretizations, preconditioners, and solvers can be applied to the SMM moment system. Thus, each iteration of the SMM is expected to be much cheaper than an analogous VEF method. 

Chapter \ref{chap:smm} defined the SMM algorithm and established the close connection between SMM and VEF. Following \textcite{cefus}, we showed that the SMM algorithm is equivalent to a VEF algorithm linearized about a diffusion solution. Thus, the SMM algorithm can be viewed as both a moment method with additive closures and a linearization of the VEF method. This connection was used to systematically convert the discrete VEF algorithms developed in Chapters \ref{chap:dgvef} and \ref{chap:rtvef} to the corresponding discrete SMMs. This includes the IP, CG, RT, and HRT methods. The SMM moment systems were preconditioned and solved using the standard techniques developed for the IP, CG, RT, and HRT discretization of radiation diffusion, respectively. This included the use of the conjugate gradient method to solve the IP, CG, and HRT methods. 

An MMS problem was used to demonstrate the accuracy of the IP, CG, RT, and HRT SMMs. All methods converged in an analogous manner to their associated VEF method. This includes the lower order of accuracy for the current seen in the RT and HRT methods. The methods were tested on both single and multi-material problems. Convergence on these problems was very close to the corresponding VEF methods with the SMM variant converging only a few iterations slower. All methods showed uniform convergence in inner preconditioned linear solver iterations. Finally, a weak scaling study was conducted to show that the SMM moment system can be scalably solved in parallel. 

\section{Generalities of the VEF Method}
In Chapter \ref{chap:disc}, the IP VEF method was used to demonstrate properties of the VEF algorithm in general. We showed that the use of the previous outer iteration as an initial guess for the inner preconditioned inner solver led to a reduction of $\sim 30\%$ in total number of inner iterations to solve the problem when compared to the use of a zero initial guess.
As the outer iteration converges, it provides an increasingly more accurate initial guess to the inner solver. This meant that the number of inner iterations at each outer decreased as the outer iteration progressed. For the zero initial guess, the number of inner iterations per outer iteration remained constant. 
The choice of the initial guess did not affect the convergence of the outer iteration. Thus, the use of the previous outer iteration's solution as an initial guess for the inner solver reduced the cost of the overall algorithm. 

We also presented two schemes to provide increased robustness and convergence on curved meshes with reentrant faces. On such a mesh, the transport equation cannot be reorderd to be block lower triangular by element precluding the use of the traditional transport sweep. Instead, the pseudo-optimal reordering of the elements presented in \textcite{graph_sweeps} is used so that the upper triangular portion of the transport system is as small possible. The resulting transport sweep lags incoming angular flux information on reentrant faces meaning the transport equation is only partially inverted at each fixed-point iteration of the VEF algorithm. Compared to an orthogonal mesh problem, the presence of reentrant faces was seen to increase the number of iterations required to converge the VEF algorithm. This was especially true for optically thin problems where lagging angular fluxes has a more global effect due to the larger mean free path in the problem. 

We investigated the effect of performing multiple partial transport inversions per fixed-point iteration. We observed a reduction in the number of fixed-point iterations to convergence that approached the convergence rates seen on the orthogonal mesh problem. However, this reduction in fixed-point iterations was not enough to reduce the total number of partial transport inversions performed. That is, when three partial inversions were performed at each outer iteration, the number of outer iterations until convergence decreased by less than 3x meaning more total partial transport inversions were performed in the simulation. This result indicates multiple partial inversions of the transport equation could provide robustness to severe mesh distortions but is not likely to be useful in reducing the cost of the simulation. 

We also investigated the use of Anderson acceleration to mitigate the slowdown associated with reentrant faces. We compared two options. The first stored previous iterates of the scalar flux only and the second stored both the scalar and angular fluxes. These schemes were referred to as ``low memory'' and ``augmented'', respectively. It was seen that the low memory option converged a few iterations slower than unaccelerated fixed-point iteration. The augmented scheme performed equivalently to fixed-point iteration on thick problems where lagging incoming angular fluxes on reentrant faces has a reduced impact. On a thin problem, Anderson acceleration with the augmented Anderson space converged a few iterations faster than fixed-point iteration. This suggests that augmenting the Anderson space with the angular flux is required to increase robustness and iterative efficiency on curved meshes. 

\section{Comparison of Methods}
Section \ref{disc_sec:comparison} provided a comparison of all the methods presented in this dissertation on the thick diffusion limit, crooked pipe, and weak scaling problems. We omit the $\Hone\times L^2(\D)$ from the following discussion as it could not be scalably solved and is thus not recommended for use in a production setting. 
It was seen that the mixed finite element-based VEF methods were qualitatively the most sensitive to severe mesh distortion. This may be due to the decreased solution regularity allowed by mixed methods or a result of the gradient of the Piola transformation allowing mesh imprinting to impact solution quality. Additionally, we showed that the solution quality of the IP and CG VEF methods were visually close. This suggests that the penalty parameter used in the IP method regularizes the solution to that of the solution of the CG VEF method. 

On the crooked pipe problem, the IP, BR2, MDLDG, CG, RT, and HRT methods used in both the VEF and SMM algorithm converged nearly identically in outer Anderson-accelerated fixed-point iterations: all methods were equivalent to $\pm 4$ iterations. This result indicates that the moment algorithm is insensitive to both the choice of the closure used to define the moment system and the discretization used to approximate the moment system. This means the closures and discretization techniques used to form a moment method can be entirely chosen by the larger algorithmic requirements such as implementational ease, computational efficiency, and multiphysics compatiblity. We note that the methods compared here all have scalable preconditioned iterative solvers. From the discussion provided in Section \ref{disc_sec:cost}, we expect the SMMs to have lower cost than the analogous VEF methods and that the CG-based methods will have the lowest cost followed by DG and then mixed finite element. Given that the solution quality between the CG and IP VEF methods was so similar, this study suggests the added degrees of freedom and more complicated preconditioner associated with the IP method are not warranted. Of the 10 moment methods presented here with efficient solvers, we recommend the CG SMM for implementation in production due to its low cost per iteration. 

\section{Future Work}
The obvious next step for this research is extending the methods presented here to a full radiation-hydrodynamics algorithm. Such an algorithm would include frequency and time dependence as well as the coupling between the transport equation and the hydrodynamics' energy balance and momentum equations. 
A one-dimensional version of the H1 algorithm presented here was used to form efficient algorithms for the mono-energetic TRT and radiation-hydrodynamics problems in \textcite{LOU2019258} and \textcite{LOU2021110393}, respectively. \textcite{yee_mc21} presents a multi-dimensional mono-energetic TRT algorithm also based on the H1 method. The efficiency of these algorithms would be greatly improved by the use of any one of the VEF or SMM discretizations presented here that have efficient solvers (i.e.~using the RT or HRT methods instead of H1). 
The primary remaining research topic is the extension to the frequency-dependent case. Such an extension is presented in one spatial dimension by \textcite{anistratov2020nonlinear,ANISTRATOV2019186} where an efficient frequency-dependent algorithm is formulated using a multi-level approach. A promising path toward a full radiation-hydrodynamics algorithm would be combining the one-dimensional radiation-hydrodynamics algorithm from \textcite{LOU2021110393}, the efficient multi-dimensional moment discretizations presented here, and the frequency-dependent algorithm of \textcite{anistratov2020nonlinear,ANISTRATOV2019186}. 

From the discussion of cost in Section \ref{disc_sec:cost}, the \gls{cg} SMM algorithm is recommended as it has the fewest number of unknowns and is the simplest to implement and precondition effectively. However, it is unknown whether using a continuous finite element space for the radiation energy density would negatively impact robustness and stability in the larger multiphysics setting. There may also be computational aspects associated with the use of a representation for the energy density that is globally coupled. That is, a continuous finite element representation would not allow the beneficial property of element-local coupling between the moment system and the hydrodynamic energy balance equation that discontinuous representations enjoy.  

Another research task is to verify the efficacy of the SMM for TRT and radiation-hydrodynamics. An \gls{rt}-based SMM radiation-hydrodynamics algorithm is particularly attractive within the hydrodynamics framework of \cite{blast}. We have designed the RT SMM moment discretization so that the left hand side operator exactly matches that of the diffusion operator used by \cite{blast}. Since the coupling to the transport solver occurs only in the right hand side terms, the linear and nonlinear solvers already in place for radiation diffusion can be reused in an SMM algorithm by simply including the SMM correction sources. As with the VEF extension to radiation-hydrodynamics, a treatment for the frequency-dependent case must be investigated. 
Finally, suboptimal orders of accuracy for the current were observed for the RT and HRT SMM and VEF methods. The impact of this reduced accuracy on the coupling of the moment system to the hydrodynamics' momentum equation should be investigated. 

\section{Coda}
This dissertation demonstrates that efficient, independent moment methods can be systematically generated by extending existing finite element discretization techniques to the moment system. Aside from the $\Hone\times L^2(\D)$ mixed finite element-based methods, all of the moment methods presented here are strong candidates for implementation in a full radiation-hydrodynamics algorithm. The methods were robust to the thick diffusion limit, inexact sweeps from reentrant faces, and strongly heterogeneous materials. Thus, the methods are primarily differentiated by the ease of their implementation and the expense of their associated scalable preconditioned iterative solvers. 

\end{document}